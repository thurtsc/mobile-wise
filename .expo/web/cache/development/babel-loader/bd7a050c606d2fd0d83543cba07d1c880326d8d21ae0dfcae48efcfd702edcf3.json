{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useState } from 'react';\nimport api from \"../services/api\";\nimport { useNavigation } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext({});\nfunction AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loadingAuth = _useState4[0],\n    setLoadingAuth = _useState4[1];\n  var navigation = useNavigation();\n  function signUp(_x, _x2, _x3) {\n    return _signUp.apply(this, arguments);\n  }\n  function _signUp() {\n    _signUp = _asyncToGenerator(function* (email, password, nome) {\n      setLoadingAuth(true);\n      try {\n        var response = yield api.post('/users', {\n          name: nome,\n          password: password,\n          email: email\n        });\n        setLoadingAuth(false);\n        navigation.goBack();\n      } catch (err) {\n        console.log(\"ERRO AO CADASTRAR\", err);\n        setLoadingAuth(false);\n      }\n    });\n    return _signUp.apply(this, arguments);\n  }\n  function signIn(_x4, _x5) {\n    return _signIn.apply(this, arguments);\n  }\n  function _signIn() {\n    _signIn = _asyncToGenerator(function* (email, password) {\n      setLoadingAuth(true);\n      try {\n        var response = yield api.post('/login', {\n          email: email,\n          password: password\n        });\n        var _response$data = response.data,\n          id = _response$data.id,\n          name = _response$data.name,\n          token = _response$data.token;\n        var data = {\n          id: id,\n          name: name,\n          token: token,\n          email: email\n        };\n        api.defaults.headers['Authorization'] = `Bearer ${token}`;\n        setUser({\n          id: id,\n          name: name,\n          email: email\n        });\n        setLoadingAuth(false);\n      } catch (err) {\n        console.log(\"ERRO AO LOGAR \", err);\n        setLoadingAuth(false);\n      }\n    });\n    return _signIn.apply(this, arguments);\n  }\n  return _jsx(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user: user,\n      signUp: signUp,\n      signIn: signIn,\n      loadingAuth: loadingAuth\n    },\n    children: children\n  });\n}\nexport default AuthProvider;","map":{"version":3,"names":["React","createContext","useState","api","useNavigation","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loadingAuth","setLoadingAuth","navigation","signUp","_x","_x2","_x3","_signUp","apply","arguments","_asyncToGenerator","email","password","nome","response","post","name","goBack","err","console","log","signIn","_x4","_x5","_signIn","_response$data","data","id","token","defaults","headers","Provider","value","signed"],"sources":["C:/Users/licia/OneDrive/√Årea de Trabalho/Financas/src/contexts/auth.js"],"sourcesContent":["import React, { createContext, useState } from 'react';\r\n\r\nimport api from '../services/api';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nexport const AuthContext = createContext({});\r\n\r\nfunction AuthProvider({ children }){\r\n  const [user, setUser] = useState(null); \r\n  const [loadingAuth, setLoadingAuth] = useState(false);\r\n\r\n  const navigation = useNavigation();\r\n\r\n\r\n  async function signUp(email, password, nome){\r\n    setLoadingAuth(true);\r\n\r\n    try{\r\n      const response = await api.post('/users', {\r\n       name: nome,\r\n       password: password,\r\n       email: email,\r\n      })\r\n      setLoadingAuth(false);\r\n\r\n      navigation.goBack();\r\n\r\n\r\n    }catch(err){\r\n      console.log(\"ERRO AO CADASTRAR\", err);\r\n      setLoadingAuth(false);\r\n    }\r\n  }\r\n\r\n  async function signIn(email, password){\r\n    setLoadingAuth(true);\r\n\r\n    try{\r\n      const response = await api.post('/login', {\r\n        email: email,\r\n        password: password\r\n      })\r\n\r\n      const { id, name, token } = response.data;\r\n\r\n      const data = {\r\n        id,\r\n        name,\r\n        token,\r\n        email,\r\n      };\r\n\r\n      api.defaults.headers['Authorization'] = `Bearer ${token}`;\r\n\r\n      setUser({\r\n        id,\r\n        name,\r\n        email,\r\n      })\r\n\r\n      setLoadingAuth(false);\r\n\r\n    }catch(err){\r\n      console.log(\"ERRO AO LOGAR \", err);\r\n      setLoadingAuth(false);\r\n    }\r\n\r\n  }\r\n\r\n  return(\r\n    <AuthContext.Provider value={{ signed: !!user, user, signUp, signIn, loadingAuth }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n\r\nexport default AuthProvider;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}