{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport { AuthContext } from \"../../contexts/auth\";\nimport Header from \"../../components/Header\";\nimport { Background, ListBalance, Area, Title, List } from \"./styles\";\nimport api from \"../../services/api\";\nimport { format } from 'date-fns';\nimport { useIsFocused } from '@react-navigation/native';\nimport BalanceItem from \"../../components/BalanceItem\";\nimport HistoricoList from \"../../components/HistoricoList\";\nimport CalendarModal from \"../../components/CalendarModal\";\nimport Icon from \"@expo/vector-icons/MaterialIcons\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Home() {\n  var isFocused = useIsFocused();\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    listBalance = _useState2[0],\n    setListBalance = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    movements = _useState4[0],\n    setMovements = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    modalVisible = _useState6[0],\n    setModalVisible = _useState6[1];\n  var _useState7 = useState(new Date()),\n    _useState8 = _slicedToArray(_useState7, 2),\n    dateMovements = _useState8[0],\n    setDateMovements = _useState8[1];\n  useEffect(function () {\n    var isActive = true;\n    function getMovements() {\n      return _getMovements.apply(this, arguments);\n    }\n    function _getMovements() {\n      _getMovements = _asyncToGenerator(function* () {\n        var date = new Date(dateMovements);\n        var onlyDate = date.valueOf() + date.getTimezoneOffset() * 60 * 1000;\n        var dateFormated = format(onlyDate, 'dd/MM/yyyy');\n        var receives = yield api.get('/receives', {\n          params: {\n            date: dateFormated\n          }\n        });\n        var balance = yield api.get('/balance', {\n          params: {\n            date: dateFormated\n          }\n        });\n        if (isActive) {\n          setMovements(receives.data);\n          setListBalance(balance.data);\n        }\n      });\n      return _getMovements.apply(this, arguments);\n    }\n    getMovements();\n    return function () {\n      return isActive = false;\n    };\n  }, [isFocused, dateMovements]);\n  function handleDelete(_x) {\n    return _handleDelete.apply(this, arguments);\n  }\n  function _handleDelete() {\n    _handleDelete = _asyncToGenerator(function* (id) {\n      try {\n        yield api.delete('/receives/delete', {\n          params: {\n            item_id: id\n          }\n        });\n        setDateMovements(new Date());\n      } catch (err) {\n        console.log(err);\n      }\n    });\n    return _handleDelete.apply(this, arguments);\n  }\n  function filterDateMovements(dateSelected) {\n    setDateMovements(dateSelected);\n  }\n  return _jsxs(Background, {\n    children: [_jsx(Header, {\n      title: \"Minhas movimenta\\xE7\\xF5es\"\n    }), _jsx(ListBalance, {\n      data: listBalance,\n      horizontal: true,\n      showsHorizontalScrollIndicator: false,\n      keyExtractor: function keyExtractor(item) {\n        return item.tag;\n      },\n      renderItem: function renderItem(_ref) {\n        var item = _ref.item;\n        return _jsx(BalanceItem, {\n          data: item\n        });\n      }\n    }), _jsxs(Area, {\n      children: [_jsx(TouchableOpacity, {\n        onPress: function onPress() {\n          return setModalVisible(true);\n        },\n        children: _jsx(Icon, {\n          name: \"event\",\n          color: \"#fff\",\n          size: 30\n        })\n      }), _jsx(Title, {\n        style: {\n          marginBottom: 20\n        },\n        children: \"Ultimas movimenta\\xE7\\xF5es\"\n      })]\n    }), _jsx(List, {\n      data: movements,\n      keyExtractor: function keyExtractor(item) {\n        return item.id;\n      },\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item;\n        return _jsx(HistoricoList, {\n          data: item,\n          deleteItem: handleDelete\n        });\n      },\n      showsVerticalScrollIndicator: false,\n      contentContainerStyle: {\n        paddingBottom: 20\n      }\n    }), _jsx(Modal, {\n      visible: modalVisible,\n      animationType: \"fade\",\n      transparent: true,\n      children: _jsx(CalendarModal, {\n        setVisible: function setVisible() {\n          return setModalVisible(false);\n        },\n        handleFilter: filterDateMovements\n      })\n    })]\n  });\n}","map":{"version":3,"names":["React","useContext","useEffect","useState","TouchableOpacity","Modal","AuthContext","Header","Background","ListBalance","Area","Title","List","api","format","useIsFocused","BalanceItem","HistoricoList","CalendarModal","Icon","jsx","_jsx","jsxs","_jsxs","Home","isFocused","_useState","_useState2","_slicedToArray","listBalance","setListBalance","_useState3","_useState4","movements","setMovements","_useState5","_useState6","modalVisible","setModalVisible","_useState7","Date","_useState8","dateMovements","setDateMovements","isActive","getMovements","_getMovements","apply","arguments","_asyncToGenerator","date","onlyDate","valueOf","getTimezoneOffset","dateFormated","receives","get","params","balance","data","handleDelete","_x","_handleDelete","id","delete","item_id","err","console","log","filterDateMovements","dateSelected","children","title","horizontal","showsHorizontalScrollIndicator","keyExtractor","item","tag","renderItem","_ref","onPress","name","color","size","style","marginBottom","_ref2","deleteItem","showsVerticalScrollIndicator","contentContainerStyle","paddingBottom","visible","animationType","transparent","setVisible","handleFilter"],"sources":["C:/Users/licia/OneDrive/Área de Trabalho/Financas/src/pages/Home/index.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { TouchableOpacity, Modal } from 'react-native';\r\nimport { AuthContext } from '../../contexts/auth'\r\nimport Header from '../../components/Header';\r\nimport { Background, ListBalance, Area, Title, List} from './styles'; \r\nimport api from '../../services/api'\r\nimport { format } from 'date-fns';\r\nimport { useIsFocused } from '@react-navigation/native';\r\nimport BalanceItem from '../../components/BalanceItem';\r\nimport HistoricoList from '../../components/HistoricoList';\r\nimport CalendarModal from '../../components/CalendarModal'\r\nimport Icon from 'react-native-vector-icons/MaterialIcons'\r\n\r\n\r\nexport default function Home(){\r\n  const isFocused = useIsFocused();\r\n  const [listBalance, setListBalance] = useState([]);\r\n  const [movements, setMovements] = useState([]);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n\r\n  const [dateMovements, setDateMovements] = useState(new Date())\r\n\r\n\r\n  useEffect(()=>{\r\n    let isActive = true;\r\n\r\n    async function getMovements(){\r\n\r\n      let date = new Date(dateMovements)\r\n      let onlyDate = date.valueOf() + date.getTimezoneOffset() * 60 * 1000;\r\n      let dateFormated = format(onlyDate, 'dd/MM/yyyy');\r\n\r\n      const receives = await api.get('/receives', {\r\n        params:{\r\n          date: dateFormated\r\n        }\r\n      })\r\n\r\n      const balance = await api.get('/balance', {\r\n        params:{\r\n          date: dateFormated \r\n        }\r\n      })\r\n\r\n      if(isActive){\r\n        setMovements(receives.data)\r\n        setListBalance(balance.data);\r\n      }\r\n    }\r\n\r\n    getMovements();\r\n\r\n    return () => isActive = false;\r\n\r\n  }, [isFocused, dateMovements])\r\n\r\n\r\n  async function handleDelete(id){\r\n    try{\r\n      await api.delete('/receives/delete', {\r\n        params:{\r\n          item_id: id\r\n        }\r\n      })\r\n\r\n      setDateMovements(new Date())\r\n    }catch(err){\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  function filterDateMovements(dateSelected){\r\n    // console.log(dateSelected);\r\n    setDateMovements(dateSelected);\r\n  }\r\n\r\n//Titulo minhas movimentações\r\n  return(\r\n    <Background>\r\n      <Header title=\"Minhas movimentações\" />\r\n\r\n      <ListBalance\r\n        data={listBalance}\r\n        horizontal={true}\r\n        showsHorizontalScrollIndicator={false}\r\n        keyExtractor={ item => item.tag }\r\n        renderItem={ ({ item }) => ( <BalanceItem data={item} /> )}\r\n      />\r\n          \r\n      <Area> \r\n        <TouchableOpacity onPress={ () => setModalVisible(true) }>\r\n          <Icon name=\"event\" color=\"#fff\" size={30} />\r\n        </TouchableOpacity>\r\n        <Title style={{marginBottom:20,}}>Ultimas movimentações</Title>\r\n      </Area> \r\n\r\n      <List\r\n        data={movements}\r\n        keyExtractor={ item => item.id }\r\n        renderItem={ ({ item }) => <HistoricoList data={item} deleteItem={handleDelete} />  }\r\n        showsVerticalScrollIndicator={false}\r\n        contentContainerStyle={{ paddingBottom: 20 }}\r\n      />\r\n\r\n      <Modal visible={modalVisible} animationType=\"fade\" transparent={true}>\r\n        <CalendarModal\r\n          setVisible={ () => setModalVisible(false) }\r\n          handleFilter={filterDateMovements}\r\n        />\r\n      </Modal>\r\n\r\n\r\n    </Background>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}